(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{136:function(a,e,s){"use strict";s.r(e);var t=s(0),n=Object(t.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"communicationguru"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#communicationguru","aria-hidden":"true"}},[a._v("#")]),a._v(" CommunicationGuru")]),s("p",[a._v("Service for sending communications in a way that is most awesome")]),s("h2",{attrs:{id:"sending-messages"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sending-messages","aria-hidden":"true"}},[a._v("#")]),a._v(" Sending messages:")]),s("p",[s("strong",[a._v("Send an SMS")])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("from api.models import Communication\nmessage = Communication.sms(to='+27..', from='+27..', message, tags=[])\n")])])]),s("p",[s("strong",[a._v("Send an Email")])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("from api.models import Communication\nmessage = Communication.email(to='+27..', from='+27..', message, tags=[])\n")])])]),s("h2",{attrs:{id:"webhooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webhooks","aria-hidden":"true"}},[a._v("#")]),a._v(" Webhooks:")]),s("h3",{attrs:{id:"incoming-status-updates"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incoming-status-updates","aria-hidden":"true"}},[a._v("#")]),a._v(" Incoming status updates:")]),s("p",[s("code",[a._v("POST /incoming/:transport/:backend/status/")])]),s("p",[s("strong",[a._v("What happens")])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("comm = Communication.get_from_payload(backend, transport, payload)\ncomm.update_status(payload)\n\ncomm.reply_received(payload)\n")])])]),s("p",[a._v("Internally this does:")]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# because the communication knows about it's backend\ncomm.get_backend().update_status(self, payload)\ncomm.get_backend().reply_received(self, payload)\n")])])]),s("p",[a._v("e.g:")]),s("p",[s("code",[a._v("POST /incoming/email/mailgun/status")])]),s("h3",{attrs:{id:"incoming-replies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incoming-replies","aria-hidden":"true"}},[a._v("#")]),a._v(" Incoming replies:")]),s("p",[s("code",[a._v("POST /incoming/:transport/:backend/reply/")])]),s("p",[a._v("e.g.:")]),s("p",[s("code",[a._v("POST /incoming/email/mailgun/reply")])]),s("h2",{attrs:{id:"creating-a-backend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-backend","aria-hidden":"true"}},[a._v("#")]),a._v(" Creating a backend:")]),s("p",[a._v("A backend must implement the following methods:")]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('class MyAwesomeBackend:\n\n    def __init__(self):\n        pass\n\n    @staticmethod\n    def get_id_from_payload(payload, always_return_id=1):\n        """\n        Given a reply, or status update payload, extract the backend message id\n        """\n\n    def send(self, message, to, **kwargs):\n        """\n        Send a message\n        """\n\n    def update_status(self, communication, payload, **kwargs):\n        """\n        Given a status update payload, update the message status\n        """\n\n    def reply_received(self, original_communication, payload, *args, **kwargs):\n        """\n        Handle a reply to a message\n        """\n\n')])])]),s("h1",{attrs:{id:"todo-scenarios"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#todo-scenarios","aria-hidden":"true"}},[a._v("#")]),a._v(" todo: Scenarios")]),s("ul",[s("li",[a._v("Define a scenario (e.g.: Appointment created, Appointment rescheduled etc.) which creates a configured collection of communications")])]),s("p",[a._v("User has Scenarios have Communications\nUser has Communications")])])}],!1,null,null,null);e.default=n.exports}}]);